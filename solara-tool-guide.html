<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solara Tool Builder Assistant</title>

    <!-- Inter font (Tailwind-first: apply via class on body) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind theme config for your brand colors -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              pano: {
                navy: "#161242",
                green: "#1FAA4A",
                blue: "#006DB0",
                darkgray: "#333333",
                lightgray: "#EEEEEE",
              },
              secondary: {
                turquoise: "#108A7D",
                teal: "#00A1BB",
                lavender: "#867EBB",
                lime: "#9FCC3B",
              },
            },
          },
        },
      };
    </script>

    <!-- React + Babel + Lucide -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Only remaining non-Tailwind styling: scrollbar pseudo-elements -->
    <style>
      .custom-scrollbar::-webkit-scrollbar {
        width: 4px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #e2e8f0;
        border-radius: 10px;
      }
    </style>
  </head>

  <body class="font-[Inter]">
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      // Lucide Icon Wrapper Component
      const Icon = ({ name, ...props }) => {
        const LucideIcon = lucide[name];
        return LucideIcon ? <LucideIcon {...props} /> : null;
      };

      // --- GEMINI API UTILS ---
      const apiKey = ""; // USER API KEY HERE

      const callGemini = async (userQuery, retryCount = 0) => {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        const systemPrompt = `
You are the Solara Custom Tool Assistant. Help educators design precise Custom Tools.

GUIDELINES FOR GENERATION:
1. Instructions: Use PLAIN TEXT only (no markdown, no bolding, no rule tags). Keep them relatively short but highly effective.
2. Role & Responsibilities: Instructions must establish a clear Role Identity (e.g., "You are an expert reading specialist...") and list Core Responsibilities.
3. Category: Choose from ["Family Engagement", "Instructional Planning", "Student Engagement", "Student Support"].
4. Guardrails: Do not refer to student names or IDs; assume this data is provided by the platform.

Output MUST be a valid JSON object following the responseSchema.
        `;

        const payload = {
          contents: [{ parts: [{ text: `Educator Need: ${userQuery}` }] }],
          systemInstruction: { parts: [{ text: systemPrompt }] },
          generationConfig: {
            responseMimeType: "application/json",
            responseSchema: {
              type: "OBJECT",
              properties: {
                title: { type: "STRING" },
                description: { type: "STRING" },
                instructions: { type: "STRING" },
                category: { type: "STRING" },
                categoryRationale: { type: "STRING" },
                recommendedFields: {
                  type: "ARRAY",
                  items: { type: "STRING" },
                },
              },
              required: [
                "title",
                "description",
                "instructions",
                "category",
                "categoryRationale",
                "recommendedFields",
              ],
            },
          },
        };

        try {
          const response = await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error?.message || "API request failed");
          }

          const result = await response.json();
          const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
          if (!text) throw new Error("Empty AI response");
          return JSON.parse(text);
        } catch (error) {
          if (retryCount < 5) {
            const delay = Math.pow(2, retryCount) * 1000;
            await new Promise((resolve) => setTimeout(resolve, delay));
            return callGemini(userQuery, retryCount + 1);
          }
          throw error;
        }
      };

      // --- DATA ---
      const APP_DATA = {
        mtss: {
          id: "mtss",
          title: "MTSS and Student Support Tools",
          shortTitle: "MTSS Tools",
          icon: <Icon name="Users" className="h-5 w-5 text-pano-green" />,
          accent: "secondary-turquoise",
          description:
            "Develop multi-tiered support systems, tiered interventions, and student assistance frameworks to improve overall student academic and behavioral outcomes.",
          summary: "Multi-tiered support systems, interventions, and student assistance.",
          tools: [
            {
              title: "SMART Goal Generator",
              category: "Student Support",
              description:
                "Helps teachers create intervention-aligned SMART goals based on student data and district expectations.",
              prompt:
                "Create a SMART goal for a student in the K–12 setting that is Specific, Measurable, Achievable, Relevant, and Time-bound, ensuring alignment with the student's current academic or behavioral need (provide a concise rationale), their tier of support in an MTSS framework (Tier 1, Tier 2, or Tier 3), and the targeted domain (e.g., literacy, math, social-emotional skills, behavior). Format the output as a SMART Goal Statement (one clear sentence), Criteria for Measurement (bullet points), and Timeline for Achievement (specific date or timeframe). Ensure the goal is asset-based, strengths-oriented, and written in clear, educator-friendly language.",
              knowledge: [
                "SMART goal exemplars",
                "District goal-setting guidance",
                "MTSS tiered intervention libraries",
              ],
              fields: [
                "Perceived need",
                "Domain (e.g., literacy, behavior)",
                "Tier of support",
                "Desired outcome timeframe",
              ],
            },
            {
              title: "MTSS Meeting Agenda Creator",
              category: "Student Support",
              description:
                "Creates a structured agenda for school-based MTSS meetings, including discussion topics, student updates, and decision-making protocols tailored to the tiered support process.",
              prompt:
                "Generate a detailed MTSS meeting agenda for a Tier 2/3 team working in a K–12 setting. Include Agenda Sections with recommended time allocations (e.g., welcome, student updates, intervention review, new referrals, action planning), Key Discussion Items for both academic and behavioral supports, Student Update Format (student name/ID, current tier, progress toward goals, next steps), Facilitator Prompts for guiding discussion toward data-driven decisions, and Action Items Section with responsible party and due dates. Present the agenda in a professional, educator-facing format with headings, bullet points, and suggested timing for a 45–60 minute meeting.",
              knowledge: [
                "MTSS meeting protocols",
                "Role-specific responsibilities (e.g., facilitator, recorder)",
              ],
              fields: [
                "Meeting type (Tier 2 or Tier 3)",
                "List of students to discuss",
                "Meeting duration",
                "Team member roles",
                "Notes from previous meetings (optional)",
              ],
            },
          ],
        },
        attendance: {
          id: "attendance",
          title: "Attendance Tools",
          shortTitle: "Attendance Tools",
          icon: <Icon name="Calendar" className="h-5 w-5 text-pano-green" />,
          accent: "secondary-lime",
          description: "Tracking, analyzing, and improving student attendance patterns.",
          summary: "Tracking, analyzing, and improving student attendance patterns.",
          tools: [
            {
              title: "Attendance Contract Generator",
              category: "Student Support",
              description:
                "Drafts personalized attendance improvement contracts that outline shared expectations, goals, and supports between the student, family, and school.",
              prompt:
                "Generate a student-centered attendance contract for a K–12 student that is collaborative, supportive, and solution-oriented. Structure the contract to include student information (name, grade, date), attendance expectations (clear, measurable targets), support strategies (school-based supports, family involvement, community resources), shared commitments (student, family, and school responsibilities), and review and check-in dates. Ensure the language is positive, encouraging, and non-punitive, emphasizing partnership and shared goals. Format for easy printing and signing.",
              knowledge: [
                "District attendance contract templates",
                "Tiered intervention guidance",
                "Family–school partnership best practices",
              ],
              fields: [
                "Identified barriers",
                "Family engagement preferences",
                "Suggested support strategies",
                "Contract timeframe",
              ],
            },
          ],
        },
        instruction: {
          id: "instruction",
          title: "Instruction and Curriculum Tools",
          shortTitle: "Curriculum Tools",
          icon: <Icon name="BookOpen" className="h-5 w-5 text-pano-green" />,
          accent: "secondary-teal",
          description: "Lesson planning, curriculum development, and instructional strategies.",
          summary: "Lesson planning, curriculum development, and instructional strategies.",
          tools: [
            {
              title: "Rubric Generator",
              category: "Instructional Planning",
              description:
                "Builds grading rubrics aligned to standards, success criteria, and assignment goals. Teachers can specify performance levels and descriptors.",
              prompt:
                "Generate a detailed rubric for a K–12 assignment, fully aligned to the provided learning standard and assignment description. Include four performance levels with clear, observable descriptors for each criterion. Ensure the criteria reflect the essential skills and knowledge from the standard and are written in student-friendly language. Format the rubric in a table with performance levels across the top and criteria down the side, ensuring descriptors are objective, equitable, and measurable.",
              knowledge: ["Standards-aligned rubric examples", "District grading policies"],
              fields: [
                "Assignment description",
                "Number of points",
                "Learning objectives",
                "Performance levels",
                "Success criteria",
              ],
            },
          ],
        },
        career: {
          id: "career",
          title: "College and Career Readiness Tools",
          shortTitle: "CCR Tools",
          icon: <Icon name="GraduationCap" className="h-5 w-5 text-pano-green" />,
          accent: "secondary-lime",
          description: "Preparing students for post-secondary success and career planning.",
          summary: "Preparing students for post-secondary success and career planning.",
          tools: [
            {
              title: "Career Pathway Exploration Tool",
              category: "Student Engagement",
              description:
                "Matches students with potential career pathways based on their interests, strengths, and academic profiles.",
              prompt:
                "Recommend career pathways for a K–12 student based on their documented interests and academic strengths. Align recommendations to a recognized career cluster framework such as the 16 Career Clusters or state equivalents.",
              knowledge: ["Career interest inventories", "State career clusters/pathways"],
              fields: [
                "Student interests",
                "Strengths/skills",
                "Preferred working style",
                "Post-grad goals",
              ],
            },
          ],
        },
        family: {
          id: "family",
          title: "Family Engagement Tools",
          shortTitle: "Family Engagement",
          icon: <Icon name="Heart" className="h-5 w-5 text-pano-green" />,
          accent: "secondary-lavender",
          description: "Building stronger connections between families, students, and schools.",
          summary: "Building stronger connections between families, students, and schools.",
          tools: [
            {
              title: "Family Update Generator",
              category: "Family Engagement",
              description:
                "Drafts regular, personalized updates to families about student progress, upcoming events, or ways to support learning at home.",
              prompt:
                "Create a biweekly family update for a K–12 student that summarizes academic progress, strengths, and next steps for learning. Use clear, friendly, and strengths-focused language that avoids educational jargon.",
              knowledge: [
                "Examples of family newsletters/messages",
                "Upcoming important dates",
                "Suggested home activities",
              ],
              fields: [
                "Student progress highlights",
                "Areas for growth",
                "Home support suggestions",
                "Upcoming events or deadlines",
              ],
            },
          ],
        },
      };

      // --- SUB-COMPONENTS ---
      function TooltipModal({ isOpen, onClose, title, content }) {
        if (!isOpen) return null;
        return (
          <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 p-4 backdrop-blur-sm">
            <div className="relative w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl">
              <button
                onClick={onClose}
                className="absolute right-4 top-4 rounded-full p-1 text-slate-400 transition-colors hover:bg-slate-100 hover:text-slate-600"
              >
                <Icon name="X" className="h-5 w-5" />
              </button>

              <div className="mb-4 flex items-center gap-3">
                <div className="rounded-lg bg-slate-100 p-2 text-pano-navy">
                  <Icon name="Lightbulb" className="h-5 w-5" />
                </div>
                <h3 className="text-xl font-bold text-pano-navy">{String(title)}</h3>
              </div>

              <div className="text-sm leading-relaxed text-slate-600 md:text-base">
                {String(content)}
              </div>

              <button
                onClick={onClose}
                className="mt-6 w-full rounded-xl bg-pano-navy py-2 font-semibold text-white transition-colors"
              >
                Got it
              </button>
            </div>
          </div>
        );
      }

      function OnboardingModal({ isOpen, onClose }) {
        if (!isOpen) return null;
        return (
          <div className="fixed inset-0 z-[60] flex items-center justify-center bg-slate-900/60 p-4 backdrop-blur-sm">
            <div className="relative w-full max-w-sm rounded-2xl bg-white p-8 text-center shadow-2xl">
              <div className="mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-blue-50 text-blue-600">
                <Icon name="Wand2" className="h-8 w-8" />
              </div>

              <h3 className="mb-3 text-xl font-bold text-slate-900">
                Welcome to Tool Assistant
              </h3>

              <p className="mb-6 text-sm leading-relaxed text-slate-600">
                This workspace helps you generate new tool ideas. Just describe a classroom
                task or challenge and AI will draft a tool for you.
              </p>

              <div className="mb-8 rounded-xl border border-amber-100 bg-amber-50 p-4">
                <p className="text-left text-xs font-medium leading-relaxed text-amber-800">
                  Note: Your tool history exists only for this current session. You can use
                  the Export feature to download your tool drafts before you leave.
                </p>
              </div>

              <button
                onClick={onClose}
                className="w-full rounded-xl bg-pano-navy py-3 text-lg font-bold text-white shadow-lg shadow-blue-900/20 transition-all active:scale-95"
              >
                Let's get started
              </button>
            </div>
          </div>
        );
      }

      function ToolCard({
        tool,
        categoryId,
        index,
        onCopy,
        onInfoClick,
        accentColor,
        initiallyExpanded = false,
      }) {
        const [isExpanded, setIsExpanded] = useState(initiallyExpanded);
        const [copyFeedback, setCopyFeedback] = useState(null);

        const triggerCopy = (text, id) => {
          onCopy(String(text), id);
          setCopyFeedback(id);
          setTimeout(() => setCopyFeedback(null), 2000);
        };

        const toolId = `${categoryId}-${index}`;
        const fields =
          tool.fields ||
          (tool.recommendedFields
            ? tool.recommendedFields.map((f) => f.fieldName || f)
            : []);

        return (
          <div className="mb-4 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-sm transition-all duration-300">
            <div
              className="flex cursor-pointer flex-col items-start justify-between gap-4 p-6 transition-colors hover:bg-slate-50 md:p-8"
              onClick={() => setIsExpanded(!isExpanded)}
            >
              <div className="w-full">
                <div className="mb-3 flex items-center justify-between gap-3">
                  <div className="flex items-center gap-3">
                    <h3 className="text-2xl font-bold text-pano-navy">
                      {String(tool.title)}
                    </h3>
                  </div>
                  <Icon
                    name="ChevronDown"
                    className={[
                      "h-6 w-6 text-slate-400 transition-transform duration-300",
                      isExpanded ? "rotate-180" : "",
                    ].join(" ")}
                  />
                </div>

                <div className="max-w-2xl text-base leading-relaxed text-slate-600">
                  {String(tool.description)}
                </div>
              </div>
            </div>

            {isExpanded && (
              <div className="grid grid-cols-1 gap-10 border-t border-slate-100 bg-white p-6 md:p-8 xl:grid-cols-2">
                <div className="space-y-6">
                  <div className="space-y-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-pano-navy">
                        <Icon name="FileText" className="h-3.5 w-3.5 text-pano-green" />
                        Tool Instructions
                      </div>

                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          triggerCopy(tool.prompt || tool.instructions, `${toolId}-instructions`);
                        }}
                        className={[
                          "flex items-center gap-2 whitespace-nowrap rounded px-4 py-1.5 text-[10px] font-bold uppercase tracking-wider text-white transition-all",
                          copyFeedback === `${toolId}-instructions` ? "bg-green-600" : "bg-blue-600",
                        ].join(" ")}
                      >
                        {copyFeedback === `${toolId}-instructions` ? (
                          <Icon name="Check" className="h-3 w-3" />
                        ) : (
                          <Icon name="Copy" className="h-3 w-3" />
                        )}
                        {copyFeedback === `${toolId}-instructions` ? "Copied!" : "Copy Instructions"}
                      </button>
                    </div>

                    <div className="whitespace-pre-wrap rounded border border-slate-100 border-l-4 border-l-pano-green bg-pano-lightgray p-6 text-sm italic leading-relaxed text-slate-700">
                      "{String(tool.prompt || tool.instructions)}"
                    </div>
                  </div>
                </div>

                <div className="grid grid-cols-1 gap-8 sm:grid-cols-2">
                  <div className="space-y-3">
                    <div className="flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-pano-navy">
                      <Icon name="Tag" className="h-3.5 w-3.5 text-pano-green" />
                      Tool Category
                    </div>
                    <div className="inline-flex items-center rounded bg-slate-800 px-3 py-1 text-xs font-bold text-white shadow-sm">
                      {String(tool.category)}
                    </div>
                  </div>

                  <div className="space-y-4">
                    <div className="flex items-center gap-2 text-[10px] font-bold uppercase tracking-widest text-pano-green">
                      <Icon name="TrendingUp" className="h-3.5 w-3.5" />
                      Recommended Fields
                    </div>
                    <ul className="space-y-3">
                      {fields.map((f, fIdx) => (
                        <li key={fIdx} className="flex items-center gap-2 text-xs text-slate-600">
                          <div
                            className="h-1.5 w-1.5 flex-shrink-0 rounded-full"
                            style={{
                              backgroundColor:
                                (accentColor && `var(--tw-${accentColor})`) || undefined,
                            }}
                          />
                          <span>{String(f)}</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      function ToolBuilderView({ onCopy, onInfoClick, onToolGenerated, drafts, onExport }) {
        const [userInput, setUserInput] = useState("");
        const [loading, setLoading] = useState(false);
        const [result, setResult] = useState(null);
        const [error, setError] = useState(null);

        const handleGenerate = async () => {
          if (!userInput.trim()) return;
          setLoading(true);
          setError(null);
          setResult(null);
          try {
            const toolData = await callGemini(userInput);
            setResult(toolData);
            onToolGenerated(toolData);
          } catch (err) {
            setError(err.message || "Encountered an error. Check API key.");
          } finally {
            setLoading(false);
          }
        };

        return (
          <div className="space-y-12">
            <div className="flex flex-col justify-between gap-6 md:flex-row md:items-end">
              <div className="max-w-3xl">
                <h2 className="mb-4 text-4xl font-bold text-pano-navy">
                  Solara Tool Builder Assistant
                </h2>
                <p className="text-lg leading-relaxed text-slate-600">
                  Describe a classroom challenge and AI will draft a tool for you.
                </p>
              </div>

              {drafts.length > 0 && (
                <button
                  onClick={onExport}
                  className="flex items-center gap-2 rounded-xl border border-slate-200 px-4 py-2.5 text-sm font-bold text-slate-600 transition-colors hover:bg-slate-50"
                >
                  <Icon name="Download" className="h-4 w-4" /> Export History
                </button>
              )}
            </div>

            <div className="space-y-6 rounded-2xl border border-slate-200 bg-white p-8 shadow-sm">
              <textarea
                className="h-40 w-full rounded-xl border border-slate-200 bg-slate-50 p-6 text-base outline-none focus:ring-2 focus:ring-green-500"
                placeholder="e.g., I need a tool for..."
                value={userInput}
                onChange={(e) => setUserInput(e.target.value)}
              />
              <button
                onClick={handleGenerate}
                disabled={loading || !userInput.trim()}
                className="flex w-full items-center justify-center gap-3 rounded-xl bg-pano-navy py-4 text-lg font-bold text-white disabled:opacity-50"
              >
                {loading ? (
                  <Icon name="Loader2" className="h-6 w-6 animate-spin" />
                ) : (
                  <Icon name="Sparkles" className="h-6 w-6 text-yellow-400" />
                )}
                {loading ? "Drafting..." : "Draft My Tool"}
              </button>
              {error && (
                <div className="rounded-xl border border-red-100 bg-red-50 p-4 text-sm text-red-600">
                  {error}
                </div>
              )}
            </div>

            {result && (
              <ToolCard
                tool={result}
                categoryId="ai-drafted"
                index={0}
                onCopy={onCopy}
                onInfoClick={onInfoClick}
                accentColor="secondary-teal"
                initiallyExpanded={true}
              />
            )}
          </div>
        );
      }

      const App = () => {
        const [activeCategory, setActiveCategory] = useState(null);
        const [activeView, setActiveView] = useState("home");
        const [isSidebarOpen, setIsSidebarOpen] = useState(false);
        const [searchQuery, setSearchQuery] = useState("");
        const [modalContent, setModalContent] = useState(null);
        const [drafts, setDrafts] = useState([]);
        const [onboardingOpen, setOnboardingOpen] = useState(false);

        const categoryOrder = ["career", "instruction", "mtss", "attendance", "family"];

        const handleCopy = (text) => {
          navigator.clipboard.writeText(text);
        };

        const handleToolGenerated = (newTool) => {
          setDrafts((prev) => [newTool, ...prev]);
        };

        const handleExport = () => {
          const content = JSON.stringify(drafts, null, 2);
          const blob = new Blob([content], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = "tool_drafts.txt";
          link.click();
        };

        const currentCategory = activeCategory ? APP_DATA[activeCategory] : null;

        return (
          <div className="flex min-h-screen bg-slate-50 text-slate-900">
            {/* Sidebar */}
            <aside
              className={[
                "fixed inset-y-0 left-0 z-40 w-72 transform border-r border-slate-200 bg-white transition-transform duration-300 ease-in-out lg:static lg:inset-0 lg:translate-x-0",
                isSidebarOpen ? "translate-x-0" : "-translate-x-full",
              ].join(" ")}
            >
              <div className="flex h-full flex-col p-6">
                <div className="mb-8 flex items-center justify-between">
                  <h1 className="text-xl font-bold text-pano-navy">Solara Guide</h1>
                  <button className="lg:hidden" onClick={() => setIsSidebarOpen(false)}>
                    <Icon name="X" className="h-5 w-5" />
                  </button>
                </div>

                <nav className="custom-scrollbar flex-1 space-y-2 overflow-y-auto">
                  <button
                    onClick={() => {
                      setActiveView("home");
                      setActiveCategory(null);
                    }}
                    className={[
                      "flex w-full items-center gap-3 rounded-xl px-4 py-3",
                      activeView === "home" && !activeCategory ? "bg-slate-100 font-bold" : "",
                    ].join(" ")}
                  >
                    <Icon name="Home" className="h-5 w-5" /> Home
                  </button>

                  <button
                    onClick={() => {
                      setActiveView("builder");
                      setActiveCategory(null);
                      setOnboardingOpen(true);
                    }}
                    className={[
                      "flex w-full items-center gap-3 rounded-xl px-4 py-3",
                      activeView === "builder" ? "bg-slate-100 font-bold" : "",
                    ].join(" ")}
                  >
                    <Icon name="Wand2" className="h-5 w-5 text-amber-500" /> Tool Assistant
                  </button>

                  <div className="px-4 pb-2 pt-4 text-xs font-bold uppercase tracking-widest text-slate-400">
                    Categories
                  </div>

                  {categoryOrder.map((id) => (
                    <button
                      key={id}
                      onClick={() => {
                        setActiveCategory(id);
                        setActiveView("home");
                      }}
                      className={[
                        "flex w-full items-center gap-3 rounded-xl px-4 py-2.5",
                        activeCategory === id ? "bg-slate-100 font-bold" : "",
                      ].join(" ")}
                    >
                      {APP_DATA[id].icon} {APP_DATA[id].shortTitle}
                    </button>
                  ))}
                </nav>
              </div>
            </aside>

            {/* Main Content */}
            <div className="flex min-h-screen flex-1 flex-col">
              <header className="sticky top-0 z-30 flex h-16 items-center gap-4 border-b border-slate-200 bg-white px-6">
                <button className="lg:hidden" onClick={() => setIsSidebarOpen(true)}>
                  <Icon name="Menu" className="h-6 w-6" />
                </button>

                <div className="relative w-full max-w-md flex-1">
                  <Icon
                    name="Search"
                    className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-slate-400"
                  />
                  <input
                    type="text"
                    className="w-full rounded-lg bg-slate-100 py-2 pl-10 pr-4 text-sm outline-none"
                    placeholder="Search tools..."
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                  />
                </div>
              </header>

              <main className="mx-auto w-full max-w-6xl p-6 md:p-10">
                {activeView === "builder" ? (
                  <ToolBuilderView
                    onCopy={handleCopy}
                    onInfoClick={setModalContent}
                    onToolGenerated={handleToolGenerated}
                    drafts={drafts}
                    onExport={handleExport}
                  />
                ) : activeCategory ? (
                  <div className="space-y-8">
                    <div className="flex items-center gap-6 rounded-xl border border-slate-200 bg-white p-8">
                      <div className="rounded-full bg-slate-50 p-4">{currentCategory.icon}</div>
                      <div>
                        <h2 className="text-3xl font-bold">{currentCategory.title}</h2>
                        <p className="text-slate-600">{currentCategory.description}</p>
                      </div>
                    </div>

                    {currentCategory.tools.map((t, i) => (
                      <ToolCard
                        key={i}
                        tool={t}
                        categoryId={activeCategory}
                        index={i}
                        onCopy={handleCopy}
                        onInfoClick={setModalContent}
                        accentColor={currentCategory.accent}
                      />
                    ))}
                  </div>
                ) : (
                  <div className="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
                    {categoryOrder.map((id) => (
                      <div
                        key={id}
                        onClick={() => setActiveCategory(id)}
                        className="cursor-pointer rounded-xl border border-slate-200 bg-white p-6 shadow-sm transition-all hover:shadow-md"
                      >
                        <div className="mb-4">{APP_DATA[id].icon}</div>
                        <h3 className="mb-2 text-lg font-bold">{APP_DATA[id].title}</h3>
                        <p className="text-sm text-slate-500">{APP_DATA[id].summary}</p>
                      </div>
                    ))}
                  </div>
                )}
              </main>
            </div>

            <TooltipModal
              isOpen={!!modalContent}
              onClose={() => setModalContent(null)}
              title={modalContent?.title}
              content={modalContent?.content}
            />
            <OnboardingModal isOpen={onboardingOpen} onClose={() => setOnboardingOpen(false)} />
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
